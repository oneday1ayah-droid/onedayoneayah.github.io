<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>One Day One Ayah - Login & Tracking Surat</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #1a472a;
            --secondary-color: #2e8b57;
            --light-color: #e9f7ef;
            --accent-color: #ffd700;
            --dark-color: #0d2818;
            --text-color: #333;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --radius: 10px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f9f7;
            color: var(--text-color);
            line-height: 1.6;
            background-image: linear-gradient(135deg, #f5f9f7 0%, #e8f5e9 100%);
            min-height: 100vh;
        }

        /* Login Screen */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-card {
            background-color: white;
            border-radius: var(--radius);
            padding: 40px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 450px;
            text-align: center;
            animation: slideUp 0.5s ease;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .login-logo {
            color: var(--primary-color);
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .login-title {
            font-size: 1.8rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: #666;
            margin-bottom: 30px;
        }

        .login-form .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .login-form label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .login-form input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .login-form input:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.2);
        }

        .login-btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 14px 25px;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }

        .login-btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .error-message {
            color: #e74c3c;
            background-color: #ffebee;
            padding: 10px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            display: none;
        }

        .user-info {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: white;
            padding: 10px 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
        }

        .logout-btn {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .logout-btn:hover {
            background-color: #c0392b;
        }

        /* Main App Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            display: none;
        }

        header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px 0;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: "ï€…";
            font-family: "Font Awesome 6 Free";
            position: absolute;
            top: -50px;
            right: -50px;
            font-size: 200px;
            opacity: 0.05;
            transform: rotate(15deg);
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            position: relative;
            z-index: 1;
        }

        header h1 i {
            color: var(--accent-color);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .institution {
            background-color: rgba(255, 255, 255, 0.2);
            display: inline-block;
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: bold;
            margin-top: 10px;
            position: relative;
            z-index: 1;
        }

        /* Tabs Styling */
        .main-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .main-tab {
            background-color: white;
            border: 2px solid var(--light-color);
            padding: 15px 30px;
            border-radius: var(--radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow);
        }

        .main-tab.active {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
            transform: translateY(-5px);
        }

        .main-tab:hover:not(.active) {
            background-color: var(--light-color);
            border-color: var(--secondary-color);
        }

        .main-tab i {
            font-size: 1.2rem;
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Period Tabs */
        .period-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .period-tab {
            background-color: white;
            border: 2px solid var(--light-color);
            padding: 12px 25px;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow);
        }

        .period-tab.active {
            background-color: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
        }

        .period-tab:hover:not(.active) {
            background-color: var(--light-color);
            border-color: var(--secondary-color);
        }

        .period-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-color);
        }

        .period-title {
            font-size: 1.8rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .period-date {
            color: #666;
            font-size: 1rem;
            background-color: var(--light-color);
            padding: 5px 15px;
            border-radius: 20px;
        }

        /* Ranking Container */
        .ranking-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (max-width: 1024px) {
            .ranking-container {
                grid-template-columns: 1fr;
            }
        }

        .ranking-card {
            background-color: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
        }

        .ranking-card:hover {
            transform: translateY(-5px);
        }

        .ranking-card h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .ranking-card h3 i {
            color: var(--secondary-color);
        }

        .ranking-list {
            list-style: none;
            max-height: 500px;
            overflow-y: auto;
            padding-right: 10px;
        }

        .ranking-list::-webkit-scrollbar {
            width: 6px;
        }

        .ranking-list::-webkit-scrollbar-track {
            background: var(--light-color);
            border-radius: 10px;
        }

        .ranking-list::-webkit-scrollbar-thumb {
            background: var(--secondary-color);
            border-radius: 10px;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
            border-radius: var(--radius);
            border-left: 5px solid var(--secondary-color);
            transition: all 0.3s ease;
        }

        .ranking-item:hover {
            background-color: var(--light-color);
            transform: translateX(5px);
        }

        .ranking-item.top-1 {
            border-left-color: #ffd700;
            background-color: #fff9e6;
        }

        .ranking-item.top-2 {
            border-left-color: #c0c0c0;
            background-color: #f5f5f5;
        }

        .ranking-item.top-3 {
            border-left-color: #cd7f32;
            background-color: #faf3eb;
        }

        .rank-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary-color);
            min-width: 50px;
            text-align: center;
        }

        .rank-medal {
            font-size: 1.5rem;
            margin-right: 10px;
        }

        .rank-medal.gold { color: #ffd700; }
        .rank-medal.silver { color: #c0c0c0; }
        .rank-medal.bronze { color: #cd7f32; }

        .ranking-info {
            flex-grow: 1;
        }

        .ranking-name {
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: var(--dark-color);
        }

        .ranking-stats {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #666;
            flex-wrap: wrap;
        }

        .stat-badge {
            background-color: var(--light-color);
            padding: 3px 10px;
            border-radius: 15px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .stat-badge.setoran {
            background-color: #e3f2fd;
            color: #1976d2;
        }

        .stat-badge.murojaah {
            background-color: #f3e5f5;
            color: #7b1fa2;
        }

        .surah-info {
            background-color: #fff3e0;
            color: #e65100;
        }

        .total-score {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1.2rem;
            min-width: 80px;
            text-align: center;
        }

        /* Input Card */
        .input-card {
            background-color: white;
            border-radius: var(--radius);
            padding: 25px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .input-card h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-card h2 i {
            color: var(--secondary-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .form-row, .surah-select-container {
                grid-template-columns: 1fr;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--secondary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.2);
        }

        .surah-select-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .ayat-info {
            font-size: 0.9rem;
            color: #666;
            margin-top: 5px;
            padding-left: 5px;
        }

        /* Buttons */
        .btn {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--radius);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .btn:hover {
            background-color: var(--primary-color);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background-color: var(--primary-color);
        }

        .btn-primary:hover {
            background-color: var(--dark-color);
        }

        .btn-danger {
            background-color: #e74c3c;
        }

        .btn-danger:hover {
            background-color: #c0392b;
        }

        .btn-warning {
            background-color: #f39c12;
        }

        .btn-warning:hover {
            background-color: #d68910;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 5px;
            margin-left: 10px;
        }

        .action-btn {
            padding: 5px 10px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .edit-btn {
            background-color: #3498db;
            color: white;
        }

        .edit-btn:hover {
            background-color: #2980b9;
        }

        .delete-btn {
            background-color: #e74c3c;
            color: white;
        }

        .delete-btn:hover {
            background-color: #c0392b;
        }

        /* Data Management */
        .data-management {
            margin-top: 40px;
        }

        .data-table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .data-table th {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .data-table tr:hover {
            background-color: var(--light-color);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        /* Live Indicator */
        .live-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            background-color: #2ecc71;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        .last-update {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.9);
            margin-top: 15px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #777;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: #ddd;
        }

        /* Performance Summary */
        .performance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .performance-card {
            background-color: white;
            border-radius: var(--radius);
            padding: 20px;
            box-shadow: var(--shadow);
            text-align: center;
        }

        .performance-card h4 {
            color: #666;
            margin-bottom: 10px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .performance-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .performance-label {
            font-size: 0.8rem;
            color: #888;
            margin-top: 5px;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 20px;
            color: #777;
            font-size: 0.9rem;
            border-top: 1px solid #eee;
            margin-top: 30px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            border-radius: var(--radius);
            padding: 30px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: var(--shadow);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-color);
        }

        .modal-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }

        .close-btn:hover {
            color: var(--primary-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .login-card {
                padding: 30px 20px;
            }
            
            .user-info {
                position: static;
                margin-bottom: 20px;
                justify-content: center;
            }
            
            .main-tab, .period-tab {
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .form-row, .surah-select-container {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
                gap: 5px;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-container" id="loginScreen">
        <div class="login-card">
            <div class="login-logo">
                <i class="fas fa-quran"></i>
            </div>
            <h2 class="login-title">One Day One Ayah Tracker</h2>
            <p class="login-subtitle">Yayasan Pendidikan Islam Al-Furqon</p>
            
            <div class="error-message" id="loginError">
                <i class="fas fa-exclamation-circle"></i> User ID atau Password salah!
            </div>
            
            <form class="login-form" id="loginForm">
                <div class="form-group">
                    <label for="userId"><i class="fas fa-user"></i> User ID</label>
                    <input type="text" id="userId" placeholder="Masukkan User ID" required>
                </div>
                
                <div class="form-group">
                    <label for="password"><i class="fas fa-lock"></i> Password</label>
                    <input type="password" id="password" placeholder="Masukkan Password" required>
                </div>
                
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </form>
        </div>
    </div>

    <!-- Main App -->
    <div class="container" id="mainApp">
        <!-- User Info -->
        <div class="user-info">
            <i class="fas fa-user-circle"></i>
            <span id="loggedInUser">User</span>
            <button class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>

        <header>
            <h1><i class="fas fa-quran"></i> Ranking Setoran Hafalan Quran</h1>
            <div class="subtitle">Monitoring Harian, Mingguan, dan Bulanan Pegawai Al-Furqon</div>
            <div class="institution">YAYASAN PENDIDIKAN ISLAM AL-FURQON</div>
            <div class="last-update">
                <span class="live-indicator"></span> Live Update - Terakhir diperbarui: <span id="last-update-time">Hari ini</span>
            </div>
        </header>

        <!-- Main Tabs -->
        <div class="main-tabs">
            <div class="main-tab active" data-tab="ranking">
                <i class="fas fa-trophy"></i> Ranking Performa
            </div>
            <div class="main-tab" data-tab="input">
                <i class="fas fa-plus-circle"></i> Input Setoran
            </div>
            <div class="main-tab" data-tab="manage">
                <i class="fas fa-edit"></i> Kelola Data
            </div>
        </div>

        <!-- Ranking Tab Content -->
        <div class="tab-content active" id="ranking-content">
            <!-- Period Tabs -->
            <div class="period-tabs">
                <div class="period-tab active" data-period="daily">
                    <i class="fas fa-calendar-day"></i> Harian
                </div>
                <div class="period-tab" data-period="weekly">
                    <i class="fas fa-calendar-week"></i> Mingguan
                </div>
                <div class="period-tab" data-period="monthly">
                    <i class="fas fa-calendar-alt"></i> Bulanan
                </div>
            </div>

            <!-- Performance Summary -->
            <div class="performance-summary">
                <div class="performance-card">
                    <h4>RATA-RATA HARIAN</h4>
                    <div class="performance-value" id="avg-daily">0</div>
                    <div class="performance-label">Ayat per orang</div>
                </div>
                <div class="performance-card">
                    <h4>PARTISIPASI</h4>
                    <div class="performance-value" id="participation-rate">0%</div>
                    <div class="performance-label">Yang sudah setor hari ini</div>
                </div>
                <div class="performance-card">
                    <h4>TOTAL SETORAN HARI INI</h4>
                    <div class="performance-value" id="total-today">0</div>
                    <div class="performance-label">Ayat</div>
                </div>
                <div class="performance-card">
                    <h4>JUMLAH MURoja'AH</h4>
                    <div class="performance-value" id="total-murojaah">0</div>
                    <div class="performance-label">Ayat</div>
                </div>
            </div>

            <!-- Daily Period Content -->
            <div class="period-content active" id="daily-content">
                <div class="period-header">
                    <div class="period-title">
                        <i class="fas fa-calendar-day"></i> Ranking Setoran Harian
                    </div>
                    <div class="period-date" id="daily-date">Hari ini, 25 Oktober 2023</div>
                </div>

                <div class="ranking-container">
                    <div class="ranking-card">
                        <h3><i class="fas fa-trophy"></i> Top Performers Hari Ini</h3>
                        <div class="ranking-list" id="daily-ranking-list">
                            <!-- Ranking harian akan diisi oleh JavaScript -->
                        </div>
                    </div>

                    <div class="ranking-card">
                        <h3><i class="fas fa-chart-line"></i> Detail Performa Harian</h3>
                        <div class="ranking-list" id="daily-detail-list">
                            <!-- Detail harian akan diisi oleh JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Weekly Period Content -->
            <div class="period-content" id="weekly-content">
                <div class="period-header">
                    <div class="period-title">
                        <i class="fas fa-calendar-week"></i> Ranking Setoran Mingguan
                    </div>
                    <div class="period-date" id="weekly-date">Minggu ini, 23-29 Oktober 2023</div>
                </div>

                <div class="ranking-container">
                    <div class="ranking-card">
                        <h3><i class="fas fa-trophy"></i> Top Performers Minggu Ini</h3>
                        <div class="ranking-list" id="weekly-ranking-list">
                            <!-- Ranking mingguan akan diisi oleh JavaScript -->
                        </div>
                    </div>

                    <div class="ranking-card">
                        <h3><i class="fas fa-chart-line"></i> Detail Performa Mingguan</h3>
                        <div class="ranking-list" id="weekly-detail-list">
                            <!-- Detail mingguan akan diisi oleh JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Monthly Period Content -->
            <div class="period-content" id="monthly-content">
                <div class="period-header">
                    <div class="period-title">
                        <i class="fas fa-calendar-alt"></i> Ranking Setoran Bulanan
                    </div>
                    <div class="period-date" id="monthly-date">Bulan Oktober 2023</div>
                </div>

                <div class="ranking-container">
                    <div class="ranking-card">
                        <h3><i class="fas fa-trophy"></i> Top Performers Bulan Ini</h3>
                        <div class="ranking-list" id="monthly-ranking-list">
                            <!-- Ranking bulanan akan diisi oleh JavaScript -->
                        </div>
                    </div>

                    <div class="ranking-card">
                        <h3><i class="fas fa-chart-line"></i> Detail Performa Bulanan</h3>
                        <div class="ranking-list" id="monthly-detail-list">
                            <!-- Detail bulanan akan diisi oleh JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Input Tab Content -->
        <div class="tab-content" id="input-content">
            <div class="input-card">
                <h2><i class="fas fa-plus-circle"></i> Input Setoran Harian</h2>
                <form id="setoran-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="nama-input"><i class="fas fa-user"></i> Nama Pegawai</label>
                            <select id="nama-input" class="form-control" required>
                                <option value="">Pilih Nama Pegawai</option>
                                <!-- Data pegawai akan diisi oleh JavaScript -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tanggal-input"><i class="fas fa-calendar"></i> Tanggal Setoran</label>
                            <input type="date" id="tanggal-input" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <!-- Setoran Section -->
                        <div class="form-group">
                            <label for="setoran-input"><i class="fas fa-book-quran"></i> Jumlah Setoran (Ayat)</label>
                            <input type="number" id="setoran-input" class="form-control" min="1" max="50" placeholder="Jumlah ayat" required>
                            
                            <div style="margin-top: 15px;">
                                <label><i class="fas fa-list"></i> Detail Surat Setoran</label>
                                <div class="surah-select-container">
                                    <select id="surah-setoran-input" class="form-control">
                                        <option value="">Pilih Surat</option>
                                        <!-- Daftar surat akan diisi oleh JavaScript -->
                                    </select>
                                    <input type="text" id="ayat-setoran-input" class="form-control" placeholder="Ayat (contoh: 1-5)">
                                </div>
                                <div class="ayat-info" id="surah-info-setoran-input"></div>
                            </div>
                        </div>
                        
                        <!-- Muroja'ah Section -->
                        <div class="form-group">
                            <label for="murojaah-input"><i class="fas fa-redo"></i> Jumlah Muroja'ah (Ayat)</label>
                            <input type="number" id="murojaah-input" class="form-control" min="0" placeholder="Jumlah ayat" required>
                            
                            <div style="margin-top: 15px;">
                                <label><i class="fas fa-list"></i> Detail Surat Muroja'ah</label>
                                <div class="surah-select-container">
                                    <select id="surah-murojaah-input" class="form-control">
                                        <option value="">Pilih Surat</option>
                                        <!-- Daftar surat akan diisi oleh JavaScript -->
                                    </select>
                                    <input type="text" id="ayat-murojaah-input" class="form-control" placeholder="Ayat (contoh: 1-10)">
                                </div>
                                <div class="ayat-info" id="surah-info-murojaah-input"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="keterangan-input"><i class="fas fa-sticky-note"></i> Keterangan Tambahan (Opsional)</label>
                        <input type="text" id="keterangan-input" class="form-control" placeholder="Catatan tambahan tentang setoran">
                    </div>

                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Simpan Setoran
                        </button>
                        <button type="button" class="btn" onclick="clearForm()">
                            <i class="fas fa-times"></i> Bersihkan Form
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Manage Tab Content -->
        <div class="tab-content" id="manage-content">
            <div class="input-card data-management">
                <h2><i class="fas fa-edit"></i> Kelola Data Setoran</h2>
                
                <div class="data-table-container">
                    <table class="data-table" id="data-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Nama</th>
                                <th>Tanggal</th>
                                <th>Setoran</th>
                                <th>Muroja'ah</th>
                                <th>Surat Setoran</th>
                                <th>Surat Muroja'ah</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="data-table-body">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="empty-state" id="empty-data-state">
                    <i class="fas fa-database"></i>
                    <p>Belum ada data setoran.</p>
                </div>
            </div>
        </div>

        <footer>
            <p>One Day One Ayah Tracker &copy; 2023 - Yayasan Pendidikan Islam Al-Furqon</p>
            <p>Monitoring performa hafalan Quran harian, mingguan, dan bulanan</p>
        </footer>
    </div>

    <!-- Edit Modal -->
    <div class="modal" id="editModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <i class="fas fa-edit"></i> Edit Data Setoran
                </div>
                <button class="close-btn" onclick="closeEditModal()">&times;</button>
            </div>
            
            <form id="edit-form">
                <input type="hidden" id="edit-id">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-nama"><i class="fas fa-user"></i> Nama Pegawai</label>
                        <select id="edit-nama" class="form-control" required>
                            <option value="">Pilih Nama Pegawai</option>
                            <!-- Data pegawai akan diisi oleh JavaScript -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="edit-tanggal"><i class="fas fa-calendar"></i> Tanggal Setoran</label>
                        <input type="date" id="edit-tanggal" class="form-control" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="edit-setoran"><i class="fas fa-book-quran"></i> Jumlah Setoran (Ayat)</label>
                        <input type="number" id="edit-setoran" class="form-control" min="1" max="50" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-murojaah"><i class="fas fa-redo"></i> Jumlah Muroja'ah (Ayat)</label>
                        <input type="number" id="edit-murojaah" class="form-control" min="0" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label><i class="fas fa-list"></i> Surat Setoran</label>
                        <div class="surah-select-container">
                            <select id="edit-surah-setoran" class="form-control">
                                <option value="">Pilih Surat</option>
                                <!-- Daftar surat akan diisi oleh JavaScript -->
                            </select>
                            <input type="text" id="edit-ayat-setoran" class="form-control" placeholder="Ayat">
                        </div>
                    </div>
                    <div class="form-group">
                        <label><i class="fas fa-list"></i> Surat Muroja'ah</label>
                        <div class="surah-select-container">
                            <select id="edit-surah-murojaah" class="form-control">
                                <option value="">Pilih Surat</option>
                                <!-- Daftar surat akan diisi oleh JavaScript -->
                            </select>
                            <input type="text" id="edit-ayat-murojaah" class="form-control" placeholder="Ayat">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="edit-keterangan"><i class="fas fa-sticky-note"></i> Keterangan</label>
                    <input type="text" id="edit-keterangan" class="form-control" placeholder="Keterangan">
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Simpan Perubahan
                    </button>
                    <button type="button" class="btn btn-danger" onclick="deleteSetoran()">
                        <i class="fas fa-trash"></i> Hapus Data
                    </button>
                    <button type="button" class="btn" onclick="closeEditModal()">
                        <i class="fas fa-times"></i> Batal
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ==================== DATA SURAT AL-QURAN ====================
        const surahList = [
            { nama: "Al-Fatihah", ayat: 7 },
            { nama: "Al-Baqarah", ayat: 286 },
            { nama: "Ali Imran", ayat: 200 },
            { nama: "An-Nisa", ayat: 176 },
            { nama: "Al-Ma'idah", ayat: 120 },
            { nama: "Al-An'am", ayat: 165 },
            { nama: "Al-A'raf", ayat: 206 },
            { nama: "Al-Anfal", ayat: 75 },
            { nama: "At-Taubah", ayat: 129 },
            { nama: "Yunus", ayat: 109 },
            { nama: "Hud", ayat: 123 },
            { nama: "Yusuf", ayat: 111 },
            { nama: "Ar-Ra'd", ayat: 43 },
            { nama: "Ibrahim", ayat: 52 },
            { nama: "Al-Hijr", ayat: 99 },
            { nama: "An-Nahl", ayat: 128 },
            { nama: "Al-Isra", ayat: 111 },
            { nama: "Al-Kahfi", ayat: 110 },
            { nama: "Maryam", ayat: 98 },
            { nama: "Ta-Ha", ayat: 135 },
            { nama: "Al-Anbiya", ayat: 112 },
            { nama: "Al-Hajj", ayat: 78 },
            { nama: "Al-Mu'minun", ayat: 118 },
            { nama: "An-Nur", ayat: 64 },
            { nama: "Al-Furqan", ayat: 77 },
            { nama: "Asy-Syu'ara", ayat: 227 },
            { nama: "An-Naml", ayat: 93 },
            { nama: "Al-Qasas", ayat: 88 },
            { nama: "Al-Ankabut", ayat: 69 },
            { nama: "Ar-Rum", ayat: 60 },
            { nama: "Luqman", ayat: 34 },
            { nama: "As-Sajdah", ayat: 30 },
            { nama: "Al-Ahzab", ayat: 73 },
            { nama: "Saba", ayat: 54 },
            { nama: "Fatir", ayat: 45 },
            { nama: "Yasin", ayat: 83 },
            { nama: "As-Saffat", ayat: 182 },
            { nama: "Sad", ayat: 88 },
            { nama: "Az-Zumar", ayat: 75 },
            { nama: "Ghafir", ayat: 85 },
            { nama: "Fussilat", ayat: 54 },
            { nama: "Asy-Syura", ayat: 53 },
            { nama: "Az-Zukhruf", ayat: 89 },
            { nama: "Ad-Dukhan", ayat: 59 },
            { nama: "Al-Jasiyah", ayat: 37 },
            { nama: "Al-Ahqaf", ayat: 45 },
            { nama: "Muhammad", ayat: 38 },
            { nama: "Al-Fath", ayat: 29 },
            { nama: "Al-Hujurat", ayat: 18 },
            { nama: "Qaf", ayat: 45 },
            { nama: "Az-Zariyat", ayat: 60 },
            { nama: "At-Tur", ayat: 49 },
            { nama: "An-Najm", ayat: 62 },
            { nama: "Al-Qamar", ayat: 55 },
            { nama: "Ar-Rahman", ayat: 78 },
            { nama: "Al-Waqi'ah", ayat: 96 },
            { nama: "Al-Hadid", ayat: 29 },
            { nama: "Al-Mujadilah", ayat: 22 },
            { nama: "Al-Hashr", ayat: 24 },
            { nama: "Al-Mumtahanah", ayat: 13 },
            { nama: "As-Saff", ayat: 14 },
            { nama: "Al-Jumu'ah", ayat: 11 },
            { nama: "Al-Munafiqun", ayat: 11 },
            { nama: "At-Taghabun", ayat: 18 },
            { nama: "At-Talaq", ayat: 12 },
            { nama: "At-Tahrim", ayat: 12 },
            { nama: "Al-Mulk", ayat: 30 },
            { nama: "Al-Qalam", ayat: 52 },
            { nama: "Al-Haqqah", ayat: 52 },
            { nama: "Al-Ma'arij", ayat: 44 },
            { nama: "Nuh", ayat: 28 },
            { nama: "Al-Jinn", ayat: 28 },
            { nama: "Al-Muzzammil", ayat: 20 },
            { nama: "Al-Muddassir", ayat: 56 },
            { nama: "Al-Qiyamah", ayat: 40 },
            { nama: "Al-Insan", ayat: 31 },
            { nama: "Al-Mursalat", ayat: 50 },
            { nama: "An-Naba", ayat: 40 },
            { nama: "An-Nazi'at", ayat: 46 },
            { nama: "Abasa", ayat: 42 },
            { nama: "At-Takwir", ayat: 29 },
            { nama: "Al-Infitar", ayat: 19 },
            { nama: "Al-Mutaffifin", ayat: 36 },
            { nama: "Al-Insyiqaq", ayat: 25 },
            { nama: "Al-Buruj", ayat: 22 },
            { nama: "At-Tariq", ayat: 17 },
            { nama: "Al-A'la", ayat: 19 },
            { nama: "Al-Ghashiyah", ayat: 26 },
            { nama: "Al-Fajr", ayat: 30 },
            { nama: "Al-Balad", ayat: 20 },
            { nama: "Asy-Syams", ayat: 15 },
            { nama: "Al-Lail", ayat: 21 },
            { nama: "Ad-Duha", ayat: 11 },
            { nama: "Asy-Syarh", ayat: 8 },
            { nama: "At-Tin", ayat: 8 },
            { nama: "Al-Alaq", ayat: 19 },
            { nama: "Al-Qadr", ayat: 5 },
            { nama: "Al-Bayyinah", ayat: 8 },
            { nama: "Al-Zalzalah", ayat: 8 },
            { nama: "Al-Adiyat", ayat: 11 },
            { nama: "Al-Qari'ah", ayat: 11 },
            { nama: "At-Takathur", ayat: 8 },
            { nama: "Al-Asr", ayat: 3 },
            { nama: "Al-Humazah", ayat: 9 },
            { nama: "Al-Fil", ayat: 5 },
            { nama: "Quraisy", ayat: 4 },
            { nama: "Al-Ma'un", ayat: 7 },
            { nama: "Al-Kawthar", ayat: 3 },
            { nama: "Al-Kafirun", ayat: 6 },
            { nama: "An-Nasr", ayat: 3 },
            { nama: "Al-Lahab", ayat: 5 },
            { nama: "Al-Ikhlas", ayat: 4 },
            { nama: "Al-Falaq", ayat: 5 },
            { nama: "An-Nas", ayat: 6 }
        ];

        // ==================== DATA USER ====================
        const users = [
            { id: "odoa01", password: "bismillah01", name: "Admin ODOA 01" },
            { id: "odoa02", password: "bismillah02", name: "Admin ODOA 02" },
            { id: "odoa03", password: "bismillah03", name: "Admin ODOA 03" }
        ];

        // ==================== DATA PEGAWAI ====================
        const pegawaiAlFurqon = [
            "Nurjayati, S.Pd",
            "Siti Khoniah, S.Pd",
            "Dinul Qoyyimah, S.Pd",
            "Baiq Riski Irhamni",
            "Ariska Candra Yuliana, S.Pd",
            "Rizka Ulfiana, S.Tp",
            "Rike Roziani Nur Safrina, S.Pd",
            "Latifah Nur Faida, S.H",
            "Azizah Ababil",
            "Awalul Khoiriyah, S.Pd",
            "Ernawati, S.Pd",
            "Fiqi Nuraini",
            "Anae Laila",
            "Roya Pusparindi, S.Pd",
            "Endah Windarti, S.Pd",
            "Prihatin, S.Pd",
            "Wiwik Nurcahyanti, S.Pd",
            "Eka Kurniawati",
            "Firda Kurnia Fitriyani",
            "Susi Dwi Ratnasari, S.Pd",
            "Zusrika, S.Pd",
            "Khusnul Umi Nasta'in, S.Pd",
            "Dimas Nahrul Fatoni, S.Pd",
            "Fidian Zahratun Nurr'aida",
            "Citra Wulansari, S.Pd",
            "Machfud Chakim, SH",
            "Finna Baity Janah, M.Pd",
            "Aisha Nabila Putri M.",
            "Dewi Lestari, S.Pd",
            "Anisa Widya Sari",
            "Fadli Nur Rohim, S.Pd",
            "Yuli Yanti Rieskiyah",
            "Teguh Setia Isma Ramadan",
            "M. Jauhar Rifqi Muaref",
            "Hasnul Afianti",
            "Akmaludin Haikal",
            "Naifa Alya Putri Firdausi",
            "Alvina Putri Ayu Fida",
            "Nurul Azizah Ulfa, S.Pd",
            "Usamah Hanif, M.Pd",
            "Cindi Viona Laurensia",
            "Lilis Ernawati",
            "M. Hasan Al-Baha Al-Baqir",
            "Riswan Dongoran, M.Pd",
            "Fatha Ardli Kusuma",
            "Fatana Bira Suli",
            "Ayu Wulandari",
            "Fajriansah Abdillah",
            "Muh. Abdul Hamid, S.H.I",
            "Zainap Assaihatul Syahidah, S.S",
            "Adistia Rahma Putri",
            "Sumarni Inda",
            "Sutrisno, S.Pd",
            "Iskandar Kholif, S.Pd",
            "Yian Hidayatul Ulfa, S.Pd",
            "Heri Kurniawan",
            "Nita Sriwayuningrum, S.Pd",
            "Dewi Sartika Wulansari, S.H",
            "Ida Avira Putri Mahesti, S.Pd",
            "Marfu'ah Ukhtiani",
            "Koliq Mawardi",
            "Diah Aprilia Devi, S.Pd",
            "Ahmad Baharudin Fatulloh",
            "Hamdan Rizki",
            "Ana Wulan Lestari"
        ];

        // ==================== DATA SETORAN ====================
        let setoranData = [
            // Data contoh untuk demo
            { 
                id: 1, 
                nama: "Nurjayati, S.Pd", 
                tanggal: "2023-10-25", 
                setoran: 8, 
                murojaah: 15, 
                surahSetoran: "Al-Baqarah",
                ayatSetoran: "1-8",
                surahMurojaah: "Al-Fatihah",
                ayatMurojaah: "1-7",
                keterangan: "Setoran baru" 
            },
            { 
                id: 2, 
                nama: "Siti Khoniah, S.Pd", 
                tanggal: "2023-10-25", 
                setoran: 10, 
                murojaah: 20, 
                surahSetoran: "Ali Imran",
                ayatSetoran: "1-10",
                surahMurojaah: "Al-Baqarah",
                ayatMurojaah: "1-10",
                keterangan: "Muroja'ah rutin" 
            }
        ];

        // ==================== VARIABLES ====================
        let currentUser = null;
        let hafizData = [];
        let editMode = false;
        let currentEditId = null;

        // ==================== FUNGSI LOGIN ====================
        function login(event) {
            event.preventDefault();
            
            const userId = document.getElementById('userId').value;
            const password = document.getElementById('password').value;
            const errorElement = document.getElementById('loginError');
            
            // Cek user
            const user = users.find(u => u.id === userId && u.password === password);
            
            if (user) {
                currentUser = user;
                errorElement.style.display = 'none';
                
                // Tampilkan aplikasi utama
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                document.getElementById('loggedInUser').textContent = user.name;
                
                // Inisialisasi aplikasi
                initializeApp();
                
                // Simpan status login di localStorage
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('currentUser', JSON.stringify(user));
            } else {
                errorElement.style.display = 'block';
                document.getElementById('password').value = '';
                document.getElementById('password').focus();
            }
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('currentUser');
            
            // Reset form login
            document.getElementById('loginForm').reset();
            
            // Tampilkan login screen
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
        }

        // ==================== FUNGSI UTAMA APLIKASI ====================
        function initializeApp() {
            // Inisialisasi data hafiz
            hafizData = pegawaiAlFurqon.map(nama => ({
                nama,
                totalSetoran: 0,
                totalMurojaah: 0,
                rataRata: 0,
                terakhirSetor: "",
                hariAktif: 0
            }));

            // Setup dropdown nama
            updateNamaDropdown();
            
            // Setup dropdown surat
            populateSurahDropdowns();
            
            // Setup form submit
            document.getElementById('setoran-form').addEventListener('submit', addSetoran);
            document.getElementById('edit-form').addEventListener('submit', updateSetoran);
            
            // Setup tab switching (main tabs)
            document.querySelectorAll('.main-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const tabId = this.getAttribute('data-tab');
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${tabId}-content`).classList.add('active');
                });
            });
            
            // Setup tab switching (period tabs)
            document.querySelectorAll('.period-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.period-tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    const period = this.getAttribute('data-period');
                    document.querySelectorAll('.period-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(`${period}-content`).classList.add('active');
                });
            });
            
            // Setup tanggal otomatis
            const today = new Date();
            document.getElementById('tanggal-input').valueAsDate = today;
            document.getElementById('edit-tanggal').valueAsDate = today;
            
            // Setup info ayat untuk surat
            document.getElementById('surah-setoran-input').addEventListener('change', function() {
                updateSurahInfo(this.value, 'surah-info-setoran-input');
            });
            
            document.getElementById('surah-murojaah-input').addEventListener('change', function() {
                updateSurahInfo(this.value, 'surah-info-murojaah-input');
            });
            
            document.getElementById('edit-surah-setoran').addEventListener('change', function() {
                updateSurahInfo(this.value, 'edit-surah-info-setoran');
            });
            
            document.getElementById('edit-surah-murojaah').addEventListener('change', function() {
                updateSurahInfo(this.value, 'edit-surah-info-murojaah');
            });

            // Inisialisasi tampilan
            updatePeriodDates();
            updateDisplay();
            
            // Auto-refresh
            setInterval(updateDisplay, 30000);
            setInterval(updateLastUpdateTime, 10000);
        }

        function updateNamaDropdown() {
            const selects = [
                'nama-input', 'edit-nama'
            ];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">Pilih Nama Pegawai</option>';
                
                pegawaiAlFurqon.forEach(nama => {
                    const option = document.createElement('option');
                    option.value = nama;
                    option.textContent = nama;
                    select.appendChild(option);
                });
            });
        }

        function populateSurahDropdowns() {
            const selects = [
                'surah-setoran-input', 
                'surah-murojaah-input',
                'edit-surah-setoran',
                'edit-surah-murojaah'
            ];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">Pilih Surat</option>';
                
                surahList.forEach(surah => {
                    const option = document.createElement('option');
                    option.value = surah.nama;
                    option.textContent = surah.nama;
                    select.appendChild(option);
                });
            });
        }

        function updateSurahInfo(surahName, infoElementId) {
            const surah = surahList.find(s => s.nama === surahName);
            const infoElement = document.getElementById(infoElementId);
            
            if (infoElement && surah) {
                infoElement.textContent = `Total ayat: ${surah.ayat}`;
            }
        }

        function updatePeriodDates() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            
            // Tanggal harian
            document.getElementById('daily-date').textContent = now.toLocaleDateString('id-ID', options);
            
            // Tanggal mingguan
            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay());
            const endOfWeek = new Date(startOfWeek);
            endOfWeek.setDate(startOfWeek.getDate() + 6);
            
            const weekStartStr = startOfWeek.toLocaleDateString('id-ID', { day: 'numeric', month: 'short' });
            const weekEndStr = endOfWeek.toLocaleDateString('id-ID', { day: 'numeric', month: 'short', year: 'numeric' });
            document.getElementById('weekly-date').textContent = `Minggu ini, ${weekStartStr} - ${weekEndStr}`;
            
            // Tanggal bulanan
            const monthStr = now.toLocaleDateString('id-ID', { month: 'long', year: 'numeric' });
            document.getElementById('monthly-date').textContent = `Bulan ${monthStr}`;
        }

        function calculateRanking(period) {
            const today = new Date().toISOString().split('T')[0];
            const todayObj = new Date();
            
            // Tentukan rentang tanggal berdasarkan periode
            let startDate, endDate;
            
            if (period === 'daily') {
                startDate = today;
                endDate = today;
            } else if (period === 'weekly') {
                startDate = new Date(todayObj);
                startDate.setDate(todayObj.getDate() - todayObj.getDay());
                startDate = startDate.toISOString().split('T')[0];
                
                endDate = new Date(todayObj);
                endDate.setDate(todayObj.getDate() + (6 - todayObj.getDay()));
                endDate = endDate.toISOString().split('T')[0];
            } else { // monthly
                startDate = new Date(todayObj.getFullYear(), todayObj.getMonth(), 1);
                startDate = startDate.toISOString().split('T')[0];
                
                endDate = new Date(todayObj.getFullYear(), todayObj.getMonth() + 1, 0);
                endDate = endDate.toISOString().split('T')[0];
            }
            
            // Hitung performa per pegawai dalam periode
            const performance = [];
            
            pegawaiAlFurqon.forEach(nama => {
                // Filter setoran berdasarkan periode
                const setoranPeriode = setoranData.filter(item => 
                    item.nama === nama && 
                    item.tanggal >= startDate && 
                    item.tanggal <= endDate
                );
                
                // Hitung total
                const totalSetoran = setoranPeriode.reduce((sum, item) => sum + item.setoran, 0);
                const totalMurojaah = setoranPeriode.reduce((sum, item) => sum + item.murojaah, 0);
                const totalScore = totalSetoran + totalMurojaah;
                
                // Hitung konsistensi
                const hariAktif = new Set(setoranPeriode.map(item => item.tanggal)).size;
                
                // Ambil detail surat terakhir
                const lastSetoran = setoranPeriode[0];
                const surahSetoran = lastSetoran ? `${lastSetoran.surahSetoran} ${lastSetoran.ayatSetoran}` : '';
                const surahMurojaah = lastSetoran ? `${lastSetoran.surahMurojaah} ${lastSetoran.ayatMurojaah}` : '';
                
                performance.push({
                    nama,
                    totalSetoran,
                    totalMurojaah,
                    totalScore,
                    hariAktif,
                    surahSetoran,
                    surahMurojaah,
                    konsistensi: hariAktif > 0 ? (hariAktif / setoranPeriode.length) * 100 : 0
                });
            });
            
            // Urutkan berdasarkan total score (setoran + murojaah) descending
            return performance.sort((a, b) => b.totalScore - a.totalScore);
        }

        function displayRanking(period) {
            const ranking = calculateRanking(period);
            
            // Update list ranking
            const rankingList = document.getElementById(`${period}-ranking-list`);
            const detailList = document.getElementById(`${period}-detail-list`);
            
            rankingList.innerHTML = '';
            detailList.innerHTML = '';
            
            if (ranking.length === 0 || ranking.every(item => item.totalScore === 0)) {
                rankingList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-chart-bar"></i>
                        <p>Belum ada data setoran untuk periode ini.</p>
                    </div>
                `;
                
                detailList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-info-circle"></i>
                        <p>Silakan input setoran harian terlebih dahulu.</p>
                    </div>
                `;
                return;
            }
            
            // Tampilkan top performers (max 10)
            const topPerformers = ranking.slice(0, 10);
            
            topPerformers.forEach((item, index) => {
                const rank = index + 1;
                let medalClass = '';
                let medalIcon = '';
                
                if (rank === 1) {
                    medalClass = 'top-1';
                    medalIcon = '<i class="fas fa-medal rank-medal gold"></i>';
                } else if (rank === 2) {
                    medalClass = 'top-2';
                    medalIcon = '<i class="fas fa-medal rank-medal silver"></i>';
                } else if (rank === 3) {
                    medalClass = 'top-3';
                    medalIcon = '<i class="fas fa-medal rank-medal bronze"></i>';
                }
                
                const rankingItem = document.createElement('div');
                rankingItem.className = `ranking-item ${medalClass}`;
                rankingItem.innerHTML = `
                    <div class="rank-number">${rank}</div>
                    ${medalIcon}
                    <div class="ranking-info">
                        <div class="ranking-name">${item.nama}</div>
                        <div class="ranking-stats">
                            <span class="stat-badge setoran">
                                <i class="fas fa-book-quran"></i> ${item.totalSetoran} ayat
                            </span>
                            <span class="stat-badge murojaah">
                                <i class="fas fa-redo"></i> ${item.totalMurojaah} ayat
                            </span>
                            ${item.surahSetoran ? `<span class="stat-badge surah-info">
                                <i class="fas fa-list"></i> ${item.surahSetoran}
                            </span>` : ''}
                        </div>
                    </div>
                    <div class="total-score">${item.totalScore}</div>
                `;
                rankingList.appendChild(rankingItem);
            });
            
            // Tampilkan detail untuk semua
            ranking.forEach((item, index) => {
                const rank = index + 1;
                
                const detailItem = document.createElement('div');
                detailItem.className = 'ranking-item';
                detailItem.innerHTML = `
                    <div class="rank-number">${rank}</div>
                    <div class="ranking-info">
                        <div class="ranking-name">${item.nama}</div>
                        <div class="ranking-stats">
                            <span class="stat-badge setoran">
                                <i class="fas fa-book-quran"></i> Setoran: ${item.totalSetoran} ayat
                                ${item.surahSetoran ? `<br><small>${item.surahSetoran}</small>` : ''}
                            </span>
                            <span class="stat-badge murojaah">
                                <i class="fas fa-redo"></i> Muroja'ah: ${item.totalMurojaah} ayat
                                ${item.surahMurojaah ? `<br><small>${item.surahMurojaah}</small>` : ''}
                            </span>
                            <span class="stat-badge">
                                <i class="fas fa-calendar-check"></i> Hari aktif: ${item.hariAktif}
                            </span>
                        </div>
                    </div>
                    <div class="total-score">${item.totalScore}</div>
                `;
                detailList.appendChild(detailItem);
            });
        }

        function updatePerformanceStats() {
            const today = new Date().toISOString().split('T')[0];
            
            // Filter data hari ini
            const dataHariIni = setoranData.filter(item => item.tanggal === today);
            const totalPegawai = pegawaiAlFurqon.length;
            const jumlahSetorHariIni = new Set(dataHariIni.map(item => item.nama)).size;
            
            // Hitung statistik
            const totalSetoranHariIni = dataHariIni.reduce((sum, item) => sum + item.setoran, 0);
            const totalMurojaahHariIni = dataHariIni.reduce((sum, item) => sum + item.murojaah, 0);
            const rataRataHarian = jumlahSetorHariIni > 0 ? Math.round(totalSetoranHariIni / jumlahSetorHariIni) : 0;
            const partisipasiRate = Math.round((jumlahSetorHariIni / totalPegawai) * 100);
            
            // Update UI
            document.getElementById('avg-daily').textContent = rataRataHarian;
            document.getElementById('participation-rate').textContent = `${partisipasiRate}%`;
            document.getElementById('total-today').textContent = totalSetoranHariIni;
            document.getElementById('total-murojaah').textContent = totalMurojaahHariIni;
        }

        function updateDataTable() {
            const tbody = document.getElementById('data-table-body');
            const emptyState = document.getElementById('empty-data-state');
            
            tbody.innerHTML = '';
            
            if (setoranData.length === 0) {
                emptyState.style.display = 'block';
                return;
            }
            
            emptyState.style.display = 'none';
            
            // Urutkan data terbaru di atas
            const sortedData = [...setoranData].sort((a, b) => b.id - a.id);
            
            sortedData.forEach((item, index) => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${item.nama}</td>
                    <td>${formatDate(item.tanggal)}</td>
                    <td>${item.setoran} ayat</td>
                    <td>${item.murojaah} ayat</td>
                    <td>${item.surahSetoran} ${item.ayatSetoran}</td>
                    <td>${item.surahMurojaah} ${item.ayatMurojaah}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn edit-btn" onclick="openEditModal(${item.id})">
                                <i class="fas fa-edit"></i> Edit
                            </button>
                            <button class="action-btn delete-btn" onclick="confirmDelete(${item.id})">
                                <i class="fas fa-trash"></i> Hapus
                            </button>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }

        function openEditModal(id) {
            const setoran = setoranData.find(item => item.id === id);
            
            if (!setoran) return;
            
            currentEditId = id;
            editMode = true;
            
            // Isi form edit dengan data
            document.getElementById('edit-id').value = setoran.id;
            document.getElementById('edit-nama').value = setoran.nama;
            document.getElementById('edit-tanggal').value = setoran.tanggal;
            document.getElementById('edit-setoran').value = setoran.setoran;
            document.getElementById('edit-murojaah').value = setoran.murojaah;
            document.getElementById('edit-surah-setoran').value = setoran.surahSetoran;
            document.getElementById('edit-ayat-setoran').value = setoran.ayatSetoran;
            document.getElementById('edit-surah-murojaah').value = setoran.surahMurojaah;
            document.getElementById('edit-ayat-murojaah').value = setoran.ayatMurojaah;
            document.getElementById('edit-keterangan').value = setoran.keterangan || '';
            
            // Tampilkan modal
            document.getElementById('editModal').style.display = 'flex';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            currentEditId = null;
            editMode = false;
        }

        function updateSetoran(event) {
            event.preventDefault();
            
            if (!currentEditId) return;
            
            // Ambil data dari form
            const nama = document.getElementById('edit-nama').value;
            const tanggal = document.getElementById('edit-tanggal').value;
            const setoran = parseInt(document.getElementById('edit-setoran').value);
            const murojaah = parseInt(document.getElementById('edit-murojaah').value);
            const surahSetoran = document.getElementById('edit-surah-setoran').value;
            const ayatSetoran = document.getElementById('edit-ayat-setoran').value;
            const surahMurojaah = document.getElementById('edit-surah-murojaah').value;
            const ayatMurojaah = document.getElementById('edit-ayat-murojaah').value;
            const keterangan = document.getElementById('edit-keterangan').value;
            
            // Validasi
            if (!nama || !tanggal || !setoran || setoran < 1) {
                alert('Mohon isi semua field yang diperlukan dengan benar!');
                return;
            }
            
            // Update data
            const index = setoranData.findIndex(item => item.id === currentEditId);
            
            if (index !== -1) {
                setoranData[index] = {
                    id: currentEditId,
                    nama,
                    tanggal,
                    setoran,
                    murojaah,
                    surahSetoran: surahSetoran || '-',
                    ayatSetoran: ayatSetoran || '-',
                    surahMurojaah: surahMurojaah || '-',
                    ayatMurojaah: ayatMurojaah || '-',
                    keterangan
                };
                
                // Update tampilan
                updateDisplay();
                updateDataTable();
                
                // Tutup modal
                closeEditModal();
                
                alert('Data berhasil diperbarui!');
            }
        }

        function deleteSetoran() {
            if (!currentEditId) return;
            
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                // Hapus data
                setoranData = setoranData.filter(item => item.id !== currentEditId);
                
                // Update tampilan
                updateDisplay();
                updateDataTable();
                
                // Tutup modal
                closeEditModal();
                
                alert('Data berhasil dihapus!');
            }
        }

        function confirmDelete(id) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                // Hapus data
                setoranData = setoranData.filter(item => item.id !== id);
                
                // Update tampilan
                updateDisplay();
                updateDataTable();
                
                alert('Data berhasil dihapus!');
            }
        }

        function addSetoran(event) {
            event.preventDefault();
            
            const nama = document.getElementById('nama-input').value;
            const tanggal = document.getElementById('tanggal-input').value;
            const setoran = parseInt(document.getElementById('setoran-input').value);
            const murojaah = parseInt(document.getElementById('murojaah-input').value);
            const surahSetoran = document.getElementById('surah-setoran-input').value;
            const ayatSetoran = document.getElementById('ayat-setoran-input').value;
            const surahMurojaah = document.getElementById('surah-murojaah-input').value;
            const ayatMurojaah = document.getElementById('ayat-murojaah-input').value;
            const keterangan = document.getElementById('keterangan-input').value;
            
            // Validasi
            if (!nama || !tanggal || !setoran || setoran < 1) {
                alert('Mohon isi semua field yang diperlukan dengan benar!');
                return;
            }
            
            // Tambahkan data baru
            const newId = setoranData.length > 0 ? Math.max(...setoranData.map(item => item.id)) + 1 : 1;
            const newSetoran = {
                id: newId,
                nama,
                tanggal,
                setoran,
                murojaah,
                surahSetoran: surahSetoran || '-',
                ayatSetoran: ayatSetoran || '-',
                surahMurojaah: surahMurojaah || '-',
                ayatMurojaah: ayatMurojaah || '-',
                keterangan
            };
            
            setoranData.unshift(newSetoran);
            
            // Reset form
            clearForm();
            
            // Update tampilan
            updateDisplay();
            updateDataTable();
            
            // Switch ke tab ranking
            document.querySelectorAll('.main-tab').forEach(t => t.classList.remove('active'));
            document.querySelector('[data-tab="ranking"]').classList.add('active');
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById('ranking-content').classList.add('active');
            
            // Pesan sukses
            alert(`Setoran berhasil ditambahkan untuk ${nama}!`);
        }

        function clearForm() {
            document.getElementById('setoran-form').reset();
            document.getElementById('tanggal-input').valueAsDate = new Date();
            document.getElementById('surah-info-setoran-input').textContent = '';
            document.getElementById('surah-info-murojaah-input').textContent = '';
        }

        function formatDate(dateString) {
            const options = { day: 'numeric', month: 'short', year: 'numeric' };
            return new Date(dateString).toLocaleDateString('id-ID', options);
        }

        function updateLastUpdateTime() {
            const now = new Date();
            const options = { 
                hour: '2-digit', 
                minute: '2-digit',
                second: '2-digit',
                timeZone: 'Asia/Jakarta'
            };
            const timeStr = now.toLocaleTimeString('id-ID', options);
            document.getElementById('last-update-time').textContent = `Hari ini ${timeStr}`;
        }

        function updateDisplay() {
            updatePerformanceStats();
            displayRanking('daily');
            displayRanking('weekly');
            displayRanking('monthly');
            updateDataTable();
            updateLastUpdateTime();
        }

        // ==================== INISIALISASI SAAT PAGE LOAD ====================
        document.addEventListener('DOMContentLoaded', function() {
            // Setup form login
            document.getElementById('loginForm').addEventListener('submit', login);
            
            // Cek jika sudah login sebelumnya
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const savedUser = localStorage.getItem('currentUser');
            
            if (isLoggedIn === 'true' && savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'block';
                    document.getElementById('loggedInUser').textContent = currentUser.name;
                    initializeApp();
                } catch (e) {
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('currentUser');
                }
            }
        });

        // ==================== FUNGSI TAMBAHAN ====================
        function addSampleData() {
            const today = new Date().toISOString().split('T')[0];
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toISOString().split('T')[0];
            
            // Ambil 10 pegawai random untuk data contoh
            const randomPegawai = [...pegawaiAlFurqon]
                .sort(() => 0.5 - Math.random())
                .slice(0, 10);
            
            const randomSurahs = [...surahList].sort(() => 0.5 - Math.random());
            
            randomPegawai.forEach((nama, index) => {
                const setoranVal = Math.floor(Math.random() * 10) + 1;
                const murojaahVal = setoranVal * 2;
                const tanggal = index % 2 === 0 ? today : yesterdayStr;
                const surahSetoran = randomSurahs[index % randomSurahs.length];
                const surahMurojaah = randomSurahs[(index + 1) % randomSurahs.length];
                
                const newId = setoranData.length > 0 ? Math.max(...setoranData.map(item => item.id)) + 1 : 1;
                setoranData.unshift({
                    id: newId,
                    nama,
                    tanggal,
                    setoran: setoranVal,
                    murojaah: murojaahVal,
                    surahSetoran: surahSetoran.nama,
                    ayatSetoran: `1-${Math.min(setoranVal, surahSetoran.ayat)}`,
                    surahMurojaah: surahMurojaah.nama,
                    ayatMurojaah: `1-${Math.min(murojaahVal, surahMurojaah.ayat)}`,
                    keterangan: `Setoran contoh hari ${index % 2 === 0 ? 'ini' : 'kemarin'}`
                });
            });
            
            updateDisplay();
            alert('Data contoh berhasil ditambahkan! Ranking akan diperbarui.');
        }

        // Tambahkan tombol untuk data contoh
        const sampleBtn = document.createElement('button');
        sampleBtn.className = 'btn';
        sampleBtn.type = 'button';
        sampleBtn.style.marginTop = '10px';
        sampleBtn.style.marginLeft = '10px';
        sampleBtn.style.backgroundColor = '#6c757d';
        sampleBtn.innerHTML = '<i class="fas fa-vial"></i> Tambah Data Contoh';
        sampleBtn.onclick = addSampleData;
        document.querySelector('.input-card').appendChild(sampleBtn);
    </script>
</body>
</html>